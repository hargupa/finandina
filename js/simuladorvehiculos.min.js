var app=angular.module("SimuladorVehiculos",[]);app.controller("SimuladorController",["$scope","$window",function(o,a){o.Math=window.Math,o.data={montoFinanciar:0,cuotaMensual:0,precioVehiculo:"",cuotaInicial:"",tasa:1.22,plazo:"",anioModelo:"",marcaVehiculo:"",minMonto:3e6,maxAnioCarro:14,maxAnioMoto:4,errorPrecio:"",errorCuota:"",errorMonto:"",ShowMonto72Meses:!0,ShowMonto72MesesCuota:!1,ShowMonto60Meses:!0,ShowMonto60MesesCuota:!1,ShowMonto48Meses:!0,ShowMonto48MesesCuota:!1,ShowMonto36Meses:!0,ShowMonto36MesesCuota:!1,ShowMonto24Meses:!0,ShowMonto24MesesCuota:!1,ShowMonto12Meses:!0,ShowMonto12MesesCuota:!1,ShowImgCarro:!0,ShowImgMoto:!1,ShowTextoPorcentaje:!1,ShowForm:!0,ShowTerminos:!1,ShowTextoUsado:!1,ShowTextoNuevo:!0,ShowErrorValor:!1,ShowModeloCarroMoto:!0,ShowModeloCarroUsado:!1,nombre:"",celular:"",email:""},o.MostrarCuota=function(a){switch(o.data.ShowMonto72Meses=!0,o.data.ShowMonto72MesesCuota=!1,o.data.ShowMonto60Meses=!0,o.data.ShowMonto60MesesCuota=!1,o.data.ShowMonto48Meses=!0,o.data.ShowMonto48MesesCuota=!1,o.data.ShowMonto36Meses=!0,o.data.ShowMonto36MesesCuota=!1,o.data.ShowMonto24Meses=!0,o.data.ShowMonto24MesesCuota=!1,o.data.ShowMonto12Meses=!0,o.data.ShowMonto12MesesCuota=!1,a){case 1:o.data.ShowMonto72Meses=!1,o.data.ShowMonto72MesesCuota=!0,o.data.plazo=72;break;case 2:o.data.ShowMonto60Meses=!1,o.data.ShowMonto60MesesCuota=!0,o.data.plazo=60;break;case 3:o.data.ShowMonto48Meses=!1,o.data.ShowMonto48MesesCuota=!0,o.data.plazo=48;break;case 4:o.data.ShowMonto36Meses=!1,o.data.ShowMonto36MesesCuota=!0,o.data.plazo=36;break;case 5:o.data.ShowMonto24Meses=!1,o.data.ShowMonto24MesesCuota=!0,o.data.plazo=24;break;case 6:o.data.ShowMonto12Meses=!1,o.data.ShowMonto12MesesCuota=!0,o.data.plazo=12}o.calcularDatos(),0==o.data.ShowImgCarro&&(o.data.ShowMonto72Meses=!1,o.data.ShowMonto72MesesCuota=!1)},o.CambiarVehiculo=function(){1==o.data.ShowImgCarro?(o.data.ShowImgCarro=!1,o.data.ShowImgMoto=!0,o.data.ShowMonto72Meses=!1,o.data.ShowMonto72MesesCuota=!1,o.data.ShowModeloCarroMoto=!0,o.data.ShowModeloCarroUsado=!1):(o.data.ShowImgCarro=!0,o.data.ShowImgMoto=!1,o.data.ShowMonto72Meses=!0,o.data.ShowMonto72MesesCuota=!1),o.data.anioModelo="",o.data.marcaVehiculo="",o.calcularDatos()},o.CambiarEstadoVehiculo=function(){1==o.data.ShowTextoNuevo?(o.data.ShowTextoUsado=!0,o.data.ShowTextoNuevo=!1,o.data.ShowModeloCarroMoto=!1,o.data.ShowModeloCarroUsado=!0):(o.data.ShowTextoUsado=!1,o.data.ShowTextoNuevo=!0,o.data.ShowModeloCarroMoto=!0,o.data.ShowModeloCarroUsado=!1),o.data.anioModelo="",o.calcularDatos()},o.mostrarTerminos=function(){o.data.ShowForm=!1,o.data.ShowTerminos=!0},o.ocultarTerminos=function(){o.data.ShowForm=!0,o.data.ShowTerminos=!1},o.calcularDatos=function(){if(o.data.errorPrecio="",o.data.errorCuota="",o.data.errorMonto="",o.data.errorModelo="",""==o.data.anioModelo)return o.data.errorModelo="ingrese el año del modelo del vehÍculo",o.data.montoFinanciar=0,o.data.cuotaMensual=0,!1;if(""==o.data.precioVehiculo)return o.data.errorPrecio="ingrese precio del vehÍculo",!1;if(""==o.data.cuotaInicial)return o.data.errorCuota="ingrese cuota Inicial del vehÍculo",!1;_precioVehiculo=o.data.precioVehiculo.replace(/\,/g,""),_cuotaInicial=parseInt(o.data.cuotaInicial.replace(/\,/g,""));var a=(new Date).getFullYear()-o.data.anioModelo;if(o.data.ShowImgCarro&&a>o.data.maxAnioCarro)return o.data.errorModelo="El modelo del vehÍculo no es factible",o.data.montoFinanciar=0,o.data.cuotaMensual=0,!1;if(o.data.ShowImgMoto&&a>o.data.maxAnioMoto)return o.data.errorModelo="El modelo del vehÍculo no es factible",o.data.montoFinanciar=0,o.data.cuotaMensual=0,!1;var e=o.calculoPorcentajeFinanciacion();if(100==e)o.data.errorCuota="Aplica financiación del "+e+"% del precio del vehÍculo";else{var t=_precioVehiculo*e/100;_cuotaInicial!=t&&(o.data.errorCuota="Debe ser del "+e+"% del precio del vehÍculo")}_montoFinanciar=_precioVehiculo-_cuotaInicial,o.data.montoFinanciar=_montoFinanciar>=0?_montoFinanciar:0,o.data.montoFinanciar<o.data.minMonto&&(o.data.errorMonto="El monto mÍnimo a financiar debe ser mayor que $"+o.data.minMonto),""!=o.data.plazo&&(o.data.cuotaMensual=o.calculoCuotaMensual(o.data.tasa,o.data.plazo,o.data.montoFinanciar))},o.calculoPorcentajeFinanciacion=function(){var a=20;return o.data.ShowImgMoto&&(o.data.ShowTextoNuevo&&o.data.plazo>=12&&o.data.plazo<=60||o.data.ShowTextoUsado&&o.data.plazo>=12&&o.data.plazo<=48)&&(a=100),o.data.ShowImgCarro&&(o.data.ShowTextoNuevo&&o.data.plazo>=12&&o.data.plazo<=60?a=100:o.data.ShowTextoUsado&&o.data.plazo>=12&&o.data.plazo<=60&&(a=30)),a},o.calculoCuotaMensual=function(o,a,e){var t=(1+(o/=100))**a,r=o*t*e/(t-1);return Math.round(r)},o.guardarInfo=function(){o.guardarInfo=function(){return o.data.errornombre="",o.data.errorcel="",o.data.erroremail="",""==o.data.nombre?(o.data.errornombre="Debe ingresar su nombre y apellido",!1):""==o.data.celular?(o.data.errorcel="Debe ingresar su numero de celular",!1):""==o.data.email?(o.data.erroremail="Debe ingresar su correo electronico",!1):(console.log("guardar Data"),void console.log("MOSTRAR MODAL"))}},o.contactenos=function(){a.location.href="formContacto.html"},o.showindex=function(){a.location.href="index.html"}}]),app.directive("mileskeypress",(function(){return{restrict:"A",require:"ngModel",link:function(o,a,e,t){var r=function(o){if(void 0===o)return"";var a=(o=o.replace(/\,/g,"")).replace(/[^0-9,]/g,"");if(a!==o)t.$setViewValue(a),t.$render();else{if(a>999){for(var e=parseInt(a).toString().split(""),r=0,n=[],d=e.length-1,s=d;s>=0;s--){var i=e[s].replace(/\,/g,"");""!=i&&(d>=3?2==r&&0!=s?(n[s]=","+i,r=0):(n[s]=i,r+=1):n[s]=i)}a=n.join("")}t.$setViewValue(a),t.$render(),t.$setValidity("onlyNumbers",!0)}return a};t.$parsers.unshift(r),t.$parsers.push(r),e.$observe("onlyNumbers",(function(){r(t.$ViewValue)}))}}})).directive("letterkeypress",(function(){return{restrict:"A",require:"ngModel",link:function(o,a,e,t){var r=function(o){if(void 0===o)return"";var a=o.replace(/[^A-Za-z ]/g,"");return a!==o?(t.$setViewValue(a),t.$render()):t.$setValidity("onlyLetters",!0),a};t.$parsers.unshift(r),t.$parsers.push(r),e.$observe("onlyLetters",(function(){r(t.$ViewValue)}))}}})).directive("numberkeypress",(function(){return{restrict:"A",require:"ngModel",link:function(o,a,e,t){var r=function(o){if(void 0===o)return"";var a=o.replace(/[^0-9]/g,"");return a!==o?(t.$setViewValue(a),t.$render()):t.$setValidity("onlyNumbers",!0),a};t.$parsers.unshift(r),t.$parsers.push(r),e.$observe("onlyLetters",(function(){r(t.$ViewValue)}))}}}));