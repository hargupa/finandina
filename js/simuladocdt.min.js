var app=angular.module("simuladorCDT",[]);app.controller("CdtController",["$scope",function(a){a.Math=window.Math,a.data={montoInversion:"",tasaEA:4.7437,tasaEA_texto:"4.74% EA",plazoDias:"",fuente:4,ica:0,modalidad:"V",montoInteresNeto:0},a.calculos=function(){if(a.data.mensaje="",""!=a.data.montoInversion)if(""!=a.data.plazoDias)if(a.data.montoInteresNeto<1e6)a.data.mensaje="La inversion m�nima es de $1.000.000";else{var e;e=a.cdtNormal(),a.data.montoInteresNeto=Math.round(e),a.data.totalInversion=parseInt(a.data.montoInversion)+parseInt(a.data.montoInteresNeto);var t=new Date;a.data.fechaFinal=t.setDate(t.getDate()+parseInt(a.data.plazoDias))}else a.data.mensaje="Debe ingresar el plazo en d�as";else a.data.mensaje="Debe ingresar el monto de la inversi�n"},a.cdtNormal=function(){var e=a.data.tasaEA/100,t=a.data.montoInversion*e/(360/a.data.plazoDias);return t-(t*(a.data.fuente/100)+t*(a.data.ica/100))},a.cdtDesmaterializado=function(){a.data.tasaEA;var e=Math.round(a.data.tasaEA/360*a.data.plazoDias).toFixed(6),t=Math.round(e*a.data.montoInversion),n=t-(Math.round(t*(a.data.fuente/100))+Math.round(t*(a.data.ica/100)));return a.data.montoInteresNeto=n,n}}]),app.directive("mileskeypress",(function(){return{restrict:"A",require:"ngModel",link:function(a,e,t,n){var o=function(a){if(void 0===a)return"";var e=(a=a.replace(/\,/g,"")).replace(/[^0-9,]/g,"");if(e!==a)n.$setViewValue(e),n.$render();else{if(e>999){for(var t=parseInt(e).toString().split(""),o=0,r=[],s=t.length-1,i=s;i>=0;i--){var d=t[i].replace(/\,/g,"");""!=d&&(s>=3?2==o&&0!=i?(r[i]=","+d,o=0):(r[i]=d,o+=1):r[i]=d)}e=r.join("")}n.$setViewValue(e),n.$render(),n.$setValidity("onlyNumbers",!0)}return e};n.$parsers.unshift(o),n.$parsers.push(o),t.$observe("onlyNumbers",(function(){o(n.$ViewValue)}))}}}));